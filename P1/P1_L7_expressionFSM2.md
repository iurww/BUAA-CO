## P1_L7_允许括号的表达式状态机

文件上传

题目编号 896-145

## 题目要求

### 1、简介

经过你的努力，你实现了检查数位、加号、乘号组成的合法数学表达式的 Verilog 自动机。但它功能还不够完善。我们需要你课上编写一个能识别**一重括号**的 Verilog 自动机。我们要求能识别的F如下：

1、表达式F中只含有数字0-9，加号"+"，乘号"*"，半角括号"("和")"。

2、表达式F可以按如下的规则产生：

a. 单个数字[0-9]是F；
b. 如果**X**是F，**Y**是F，则**X+Y**也是F；
c. 如果**X**是F，**Y**是F，则**X\*Y**也是F；
d. 如果**X**是F，且**X**中不含括号，那么(X)也是F。

应用规则2.d，我们就可以生成(1+2)*(3+4)这样的表达式。但是我们生成不了((1+2)*(3+4))这样的表达式，因为它的括号有嵌套。

### 2、模块规格

模块名：string2。

| 信号名  | 方向 | 描述         |
| ------- | ---- | ------------ |
| clk     | I    | 时钟信号     |
| clr     | I    | 异步复位信号 |
| in[7:0] | I    | 输入的字符   |
| out     | o    | 输出         |

### 3、功能要求

每个时钟上升沿，状态机从 in 中读入一个ASCII编码的字符。假设读入的第 i 个字符为(ci)，则第 n 个时钟上升沿时，可以拼出一个字符串: s=c1 c2....cn

我们需要你在此时判断s是否符合表达式F的定义。假如 s 符合 F 的定义，那么 out 应输出 1 ，否则输出 0 。

另外，每个 clr 上升沿时，请清零状态；如果 clk 的上升沿时 clr 为 1，也需要清零状态。清零后，上面定义的字符串(s)也应从空串开始计算。如果(s)当前是空串，out也应输出0。注意，我们不需要你分析表达式的语法和语义，只要判断形式上合法性就可以正确求解；也**不需要你识别两重及以上的括号**，当然如果你能设计识别n重括号的方法，我们是鼓励的。

### 4、输入输出样例

时序规范：总是保证in信号稳定时clk才产生上升沿。

输入：s=(1+2+3+4) 输出：out=1

输入：s=(1+2+3+ 输出：out=0

示范波形（输入s=1+(1+2)*(3+1))： ![p1.1.4.1.png](http://10.212.27.185:9199/cscore-image/tianqijian/f8841308-31a8-49a5-bf68-dc12398b6a20/p1.1.4.1.png)

### 5、提交要求

- 必须严格按照模块的端口定义。
- 文件内模块名:string2 (注意修改)